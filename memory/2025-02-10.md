# 2025-02-10 â€” Figma Components + Linear Consolidation

## Figma Component Library (LockN Score pilot)
- Built 9 components from scratch on "ğŸ§© Components" page in "LockN AI" file
- Components: Button/Primary, Button/Secondary, Button/Ghost, Card/Default, Badge/Status, Score/Digit, Score/ServeIndicator, Score/RallyCounter, Score/PlayerCard, Input/Text
- All use 56 design tokens (3 collections: LockN Colors 24 vars Dark/Light, LockN Spacing 14, LockN Typography 18)
- Variable binding pattern: `boundPaint()` helper with `figma.variables.setBoundVariableForPaint()`
- Inter font family throughout
- Verified visually via screenshot â€” all working on dark background

## Linear Workspace Consolidation (in progress)
- Audited 30 projects, identified ~15 duplicates to consolidate
- Proposed Initiative-based hierarchy to Sean (approved):
  - ğŸ“ LockN Score, ğŸ’° Revenue, ğŸ—ï¸ Platform, ğŸ§  LockN AI Services, ğŸ¨ Design & UX, ğŸ¤– Agent & Tooling, ğŸ“ˆ Marketing & Growth, ğŸ’¹ XRPL Trading
- Spawned background task that partially completed then crashed on JSON parse
- Took over manually â€” cataloged all issue counts across candidate projects
- **Still TODO**: Move issues from losersâ†’winners, archive empties, create Initiatives

### Duplicate Map (key migrations remaining)
- System Improvements: `bbdccf53` â†’ `7dc9e562` (~40+ issues)
- Auth & Security: `8e1fcf5e` â†’ `49c38e73` (11 issues)
- C-Suite Agents: `4e8c4643` â†’ `24a7ccb5` (9 issues)
- XRPL Trading: `03496026` â†’ `3bcff9b9` (7 issues)
- Revenue: `eaf2bf52` â†’ marketing/`56c6969c` (7 issues)
- Memory: `c0966b8a` â†’ `e7453af7` (2 issues)
- UX Overhaul `b78965b1` and LockN Services `329b83e4` â€” already empty, archive directly

## Figma Technical Notes
- `layoutSizingHorizontal` must be set AFTER appending child to auto-layout frame
- Use `figma.setCurrentPageAsync()` not `figma.currentPage =`
- Bridge plugin must run from Design mode (Dev mode = read-only)

## Next Steps
1. Complete Linear issue migrations + archive empties
2. Create 6-8 Initiatives, assign projects
3. iPad Dashboard layout on Figma Score page
4. Build remaining components: Nav/Tab, Toggle/Switch, Modal/Dialog, Scoreboard, Timer/Clock

## Score MVP â€” Demo Sprint (afternoon session)
- **Key discovery:** Code was 90% done but tickets said "Backlog" â€” 4 days of commits (rally mode, audio wiring, mode selection, spectator dashboard) never reflected in Linear
- Fixed 5 TS build errors, circular import in db/models.py, missing pip deps
- Volume-mounted new source into running container (bypassed 10-min PyTorch rebuild)
- Connected containers to Caddy test network with DNS aliases
- Verified full pipeline: session creation â†’ WebSocket â†’ audio stream â†’ rally counting â†’ broadcast
- Rebuilt frontend with Auth0 demo bypass
- All endpoints live on test.lockn.ai
- Marked LOC-367, 368, 369, 370 as Done (were already committed)

## Ops Agent Created
- Daily cron job (8am ET) running on Deepseek model
- Audits: naming convention, orphan issues, stale In Progress, WIP limits, blocker chains, initiative coverage
- Job ID: 881844c8-9ee5-4972-87ef-39a26c84c440
- First test run fired

## Observability Gap Identified
- Root cause: No CI â†’ Linear sync, no deployment version tracking, no "definition of done" enforcement
- Proposed: GitHub Actions on merge â†’ auto-close Linear tickets, /version endpoint for drift detection

## Docker/Infra Notes (important for future builds)
- lockn-score-api image requires ~4GB download (PyTorch 915MB + NVIDIA CUDA libs ~2GB + deps)
- NEVER use `docker compose build --no-cache` on this service â€” busts pip layer cache
- docker-compose.override.yml trick: volume-mount `./src:/app/src` + `--reload` for instant code changes without rebuild
- Caddy test network: `lockn-ai-platform_lockn-test-net` â€” score containers need `docker network connect` with aliases `score-api-test` and `score-web-test`
- Auth0 demo bypass: `VITE_DEMO_MODE_BYPASS_AUTH: "true"` in docker-compose.yml (currently enabled for demo)

## Score API Architecture (verified working)
- Session store: in-memory dict `_sessions` (not persistent â€” restarts lose sessions)
- Three modes: SoloMode, RallyMode, GameMode â€” all in `src/modes/`
- Fusion debounce: 280ms (`FUSION_MIN_EVENT_INTERVAL_SEC = 0.28`)
- Audio confidence threshold for hit: 0.55
- WebSocket binary protocol: 0x01 = video frame (JPEG), 0x02 = audio chunk (float32 PCM 16kHz)
- Broadcast via rooms system in `src/api/broadcast.py`

## Investor Demo Prep
- Sean needs: 2 iPhones, 1 iPad, phone tripod, ping pong table
- Flow: iPad creates session â†’ iPhones join via QR â†’ audio streams bounce detection â†’ rally counts on iPad
- Fallback: manual +1 buttons if audio detection is flaky in noisy environment
- PANNs model not yet tuned for specific table/room acoustics
